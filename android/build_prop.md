# Android属性之build.prop生成过程


## build.prop

Android的build.prop文件是在Android编译时刻收集的各种`property`（LCD density/语言/编译时间, etc.），编译完成之后，文件生成在out/target/product/<board>/system/目录下。在Android运行时刻可以通过`property_get()`[c/c++域] / `SystemProperties_get*()`[Java域]读取这些属性值。

## 默认属性

``` shell
#!/bin/bash

echo "# begin build properties"
echo "# autogenerated by buildinfo.sh"

echo "ro.build.id=$BUILD_ID"
echo "ro.build.display.id=$BUILD_DISPLAY_ID"
echo "ro.build.version.incremental=$BUILD_NUMBER"
echo "ro.build.version.sdk=$PLATFORM_SDK_VERSION"
echo "ro.build.version.preview_sdk=$PLATFORM_PREVIEW_SDK_VERSION"
echo "ro.build.version.codename=$PLATFORM_VERSION_CODENAME"
echo "ro.build.version.all_codenames=$PLATFORM_VERSION_ALL_CODENAMES"
echo "ro.build.version.release=$PLATFORM_VERSION"
echo "ro.build.version.security_patch=$PLATFORM_SECURITY_PATCH"
.....

```
>file:build/tools/buildinfo.sh

## build.prop的生成

### 创建build.prop

1. 指定build.prop
```
BUILDINFO_SH := build/tools/buildinfo.sh
```

2. 生成
```
...
bash $(BUILDINFO_SH) >> $@
...
```
>file: build/core/Makefile

build.prop主要是通过Makefile制作生成.

## 属性的添加

1. buildinfo.sh

2. system.prop

在板级下添加.

3. ADDITIONAL_BUILD_PROPERTIES

收集系统中的各个属性,在系统编译时进行收集,主要作用于build阶段

```
ADDITIONAL_BUILD_PROPERTIES := \                            
    $(call collapse-pairs, $(ADDITIONAL_BUILD_PROPERTIES))
```

```
ADDITIONAL_BUILD_PROPERTIES += ro.bionic.ld.warning=1
```

4. PRODUCT_PROPERTY_OVERRIDES

在板级设置中添加.

```
PRODUCT_PROPERTY_OVERRIDES +=    \       
    ro.debuggable=1              \
    service.adb.root=1
```

## 参考

1. [Android属性之build.prop生成过程分析](http://blog.csdn.net/thl789/article/details/7014300)
